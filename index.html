<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Real Count Monitoring</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    <!-- Load Google Charts -->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/2.0.0/css/dataTables.dataTables.css" />
    <link rel="stylesheet" href="https://demo.getstisla.com/assets/modules/datatables/datatables.min.css">
    <link rel="stylesheet" href="https://demo.getstisla.com/assets/modules/datatables/DataTables-1.10.16/css/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" href="https://demo.getstisla.com/assets/modules/datatables/Select-1.2.4/css/select.bootstrap4.min.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.2.0/css/bootstrap.min.css"/>
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/dataTables.bootstrap5.min.css"/>
<link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.4.1/css/responsive.bootstrap5.min.css"/>
  
  <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
  <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap5.min.js"></script>
  <script src="https://cdn.datatables.net/responsive/2.4.1/js/dataTables.responsive.min.js"></script>
  <script src="https://cdn.datatables.net/responsive/2.4.1/js/responsive.bootstrap5.min.js"></script>

</head>
  </head>
<body>
<header>
<nav class="navbar navbar-expand-lg bg-body-tertiary">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">Real Count Monitoring</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="#">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">Link</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Dropdown
            </a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#">Action</a></li>
              <li><a class="dropdown-item" href="#">Another action</a></li>
              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item" href="#">Something else here</a></li>
            </ul>
          </li>
          <li class="nav-item">
            <a class="nav-link disabled" aria-disabled="true">Disabled</a>
          </li>
        </ul>
        <form class="d-flex" role="search">
          <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
          <button class="btn btn-outline-success" type="submit">Search</button>
        </form>
      </div>
    </div>
  </nav>
</header>

  <!-- Konten Utama -->
    <main>
        <!-- Follow these instructions, please! -->
    <div class="container py-5">
        <div class="row">
            <div class="col-lg-4">
                <h1 class="h2">Hasil Real Count KPU</h1>
                <div id="chart_div" ></div>
                <p>Data bersumber dari API Sirekap KPU <br>https://sirekap-obj-data.kpu.go.id/pemilu/hhcw/ppwp.json </p>
                <div class="">
                    <a href="./view_data_ppwp_kecamatan.html">view_data_ppwp_kecamatan.html</a>
            
                </div>
                <p>Thanks! <span class="text-danger">♥</span></p>

               
                    </div>
                    <div class="col-lg-8">
                        <h1 class="h2" id="hitung-ulang-title">Hasil Hitung Ulang Mardianta</h1>
                        <div class="row">
                            <div class="col-lg-6">
                                <div id="chart_suara_kpu"></div>
                                <p>Data bersumber dari API Sirekap KPU <br>https://sirekap-obj-data.kpu.go.id/pemilu/hhcw/ppwp.json </p>
                    

                            </div>
                            <div class="col-lg-6">
                                <div id="chart_suara_hitung_ulang" ></div>
                                <p>Data bersumber dari API Sirekap KPU <br>https://sirekap-obj-data.kpu.go.id/pemilu/hhcw/ppwp.json </p>

                            </div>

                        </div>
                        

                        <!-- <h2>Suara KPU</h2> -->
                    <!-- Chart untuk suara KPU -->
        
                    <!-- <h2>Suara Hitung Ulang</h2> -->
                    <!-- Chart untuk suara hitung ulang -->
                    <!-- style="width: 500px; height: 300px;" -->
        
        
                    <script>
                        // Memuat modul Google Charts
                        google.charts.load('current', {'packages':['corechart']});
        
                        // Memuat data dari URL
                        google.charts.setOnLoadCallback(loadData);
        
                        function loadData() {
                            // Memuat data JSON dari URL
                            var url = 'https://mardianta.github.io/data_ppwp/hitung_ulang.json';
                            var xhr = new XMLHttpRequest();
                            xhr.open('GET', url, true);
                            xhr.responseType = 'json';
                            xhr.onload = function() {
                                if (xhr.status === 200) {
                                    var jsonData = xhr.response;
                                    drawCharts(jsonData);
                                    var total_tps = jsonData.total_tps;
                                    var percent = Number(total_tps/823366*100).toFixed(2);
                                    var tpsTitle = document.getElementById("hitung-ulang-title");
                                    tpsTitle.innerHTML = "Hasil Hitung Ulang Mardianta ("+total_tps+" TPS)";
                                } else {
                                    console.error('Failed to load JSON data from ' + url);
                                }
                            };
                            xhr.send();
                        }
        
                        // Fungsi untuk membuat chart
                        function drawCharts(jsonData) {
                            // Fungsi untuk membuat satu chart
                            function drawChart(chartData, chartId, chartTitle) {
                                // Menyiapkan data untuk chart
                                var data = new google.visualization.DataTable();
                                data.addColumn('string', 'Kandidat');
                                data.addColumn('number', 'Suara');
        
                                for (var candidate in chartData) {
                                    data.addRow([candidate, chartData[candidate]]);
                                }
        
                                var options = {
                                title: chartTitle,
                                pieHole: 0.3 // Mengatur lebar donat
                            };
        
                                // Membuat chart baru
                                var chart = new google.visualization.PieChart(document.getElementById(chartId));
                                chart.draw(data, options);
                            }

                            var total_tps_kpu = jsonData.total_tps_kpu;
                            var total_tps_ulang = jsonData.total_tps_ulang;
                            var percent_kpu = Number(total_tps_kpu/823366*100).toFixed(2);
                            var percent_ulang = Number(total_tps_ulang/823366*100).toFixed(2);
        
                            // Memanggil fungsi drawChart untuk setiap data JSON
                            drawChart(jsonData.suara_kpu, 'chart_suara_kpu', 'Suara KPU ('+percent_kpu+'%)');
                            drawChart(jsonData.suara_hitung_ulang, 'chart_suara_hitung_ulang', 'Suara Hitung Ulang ('+percent_ulang+'%)');
                        }
                    </script>
                        <p>
                        <a class="btn btn-primary" href="https://github.com/twbs/bootstrap/blob/main/.github/CONTRIBUTING.md#bug-reports" rel="noopener noreferrer" target="_blank">Read bug report guidelines</a>
                        </p>
                        <p>Once you're set, replace the contents of this page and share the link with us in a <a href="https://github.com/twbs/bootstrap/issues/new/choose" rel="noopener noreferrer" target="_blank">new issue</a>.</p>
                        <p>Thanks! <span class="text-danger">♥</span></p>
        

                    </div>

                </div>
        <div class="row">
            <div class="col-lg-12">
                <div class="container">
                    <h2 id="tps-bermasalah-title">Data TPS Bermasalah</h2>
                    <table id="data-tabale" class="table table-striped dt-responsive nowrap" style="width:100%">
                        <thead>
                            <tr>
                                <!-- <th>Kode Kelurahan</th> -->
                                <th>Kode TPS</th>
                                <th>Anies</th>
                                <th>Ganjar</th>
                                <th>Prabowo</th>
                                <th>Total</th>
                                <th>Link C1</th>
                                <th>Link Detail TPS</th>
                                
                            </tr>
                        </thead>
                        <tbody id="tps-bermasalah-body"></tbody>
                    </table>
            
                    <script>
                        document.addEventListener("DOMContentLoaded", function() {
                          
                                var url = `https://mardianta.github.io/data_ppwp/data_tps_bermasalah.json`;
                                loadData(url);
                            
                  
                            // Fungsi untuk memuat data dari URL yang diberikan
                            function loadData(url) {
                                fetch(url)
                                    .then(response => response.json())
                                    .then(data => {
                                        // Panggil fungsi untuk menampilkan data setelah menerima data
                                        displayData(data);
                                    })
                                    .catch(error => console.error('Error fetching JSON:', error));
                            }
                  
                            // Fungsi untuk menampilkan data dalam tabel
                            function displayData(jsonData) {
                                var count_tps = jsonData.length;
                                var tpsTitle = document.getElementById("tps-bermasalah-title");
                                tpsTitle.innerHTML = "Data TPS Bermasalah ("+count_tps+" TPS)";
                                var tpsBody = document.getElementById("tps-bermasalah-body");
                                // Bersihkan isi tabel sebelum menambahkan data baru
                                tpsBody.innerHTML = "";
                  
                                for (var key in jsonData) {
                                    if (jsonData.hasOwnProperty(key)) {
                                        var row = document.createElement("tr");
                                        var data = jsonData[key];
                                        var chartData = data.data_tps.chart;
                                        // var kode_tps = data.kode_tps;
                                        var anies = 0;
                                        var prabowo = 0;
                                        var ganjar = 0;
                                        var chartDataHtml = '';
                                        var images = data.data_tps.images[1];
                                        if (chartData) {
                                          anies = data.data_tps.chart['100025'];
                                          prabowo = data.data_tps.chart['100026'];
                                          ganjar = data.data_tps.chart['100027'];
                                        //     for (var chartKey in chartData) {
                                        //         if (chartData.hasOwnProperty(chartKey)) {
                                        //             chartDataHtml += `<div>${chartKey}: ${chartData[chartKey]}</div>`;
                                        //             // Jumlahkan nilai 100025, 100026, dan 100027
                                        //             if (["100025", "100026", "100027"].includes(chartKey)) {
                                                        total = anies+prabowo+ganjar;
                                        //             }
                                        //         }
                                        //     }
                                        }
                                        // Tambahkan total ke dalam kolom "Total"
                                        // chartDataHtml += `<div>Total: ${total}</div>`;
                                        row.innerHTML = `
                                            <td>${data.kode_tps}</td>
                                            <td>${anies}</td>
                                            <td>${prabowo}</td>
                                            <td>${ganjar}</td>
                                            <td>${total}</td>
                                            <td><a href="${images}">C1</a></td>
                                            <td><a href="https://pemilu2024.kpu.go.id/pilpres/hitung-suara/${data.kode_prov}/${data.kode_kab}/${data.kode_kec}/${data.kode_kel}/${data.kode_tps}">Detail TPS KPU</a></td>
                                            
                                            
                                        `;
                                        tpsBody.appendChild(row);
                                    }
                                }
                            }
                  
                            // Panggil fungsi untuk memuat data dengan URL default saat halaman dimuat
                            var defaultUrl = `https://mardianta.github.io/data_ppwp/data_tps_bermasalah.json`;
                            loadData(defaultUrl);
                        });
                    </script>
            
                </div>

            </div>

        </div>
    </div>
    
   

    <!-- Div untuk menampilkan grafik -->

        <!-- <div class="container">
            <h2>Daftar Provinsi</h2>
            <table>
                <thead>
                    <tr>
                        <th>Nama</th>
                        <th>Kode</th>
                        <th>Tingkat</th>
                    </tr>
                </thead>
                <tbody id="provinsi-body"></tbody>
            </table>
        <ul id="provinsi-list"></ul>
        </div> -->

        <script>
            document.addEventListener("DOMContentLoaded", function() {
                // URL JSON
                var url = "https://mardianta.github.io/data_ppwp/ppwp_0.json";
    
                // Mengambil data JSON dari URL
                fetch(url)
                .then(response => response.json())
                .then(data => {
                    // Menampilkan data JSON dalam tabel
                    var provinsiBody = document.getElementById("provinsi-body");
                    data.forEach(function(provinsi) {
                        var row = document.createElement("tr");
                        row.innerHTML = `<td>${provinsi.nama}</td><td>${provinsi.kode}</td><td>${provinsi.tingkat}</td>`;
                        provinsiBody.appendChild(row);
                    });
                })
                .catch(error => console.error('Error fetching JSON:', error));
            });
        </script>
    </main>
  


<footer class="footer mt-auto py-3 bg-dark text-white">
    <div class="container text-center">
      <span>© 2024 Hak Cipta dilindungi Undang-undang</span>
    </div>
  </footer>

  <script src="chart_ppwp_kpu.js"></script>

  <script>
    $(document).ready(function () {
    $('#data-table').DataTable();
});

  </script>

<script src="https://cdn.datatables.net/2.0.0/js/dataTables.js"></script>
<script src="https://demo.getstisla.com/assets/modules/datatables/datatables.min.js"></script>
<script src="https://demo.getstisla.com/assets/modules/datatables/Select-1.2.4/js/dataTables.select.min.js"></script>

</body>
</html>
