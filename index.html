<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WPScan Report Generator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        h1 {
            text-align: center;
        }
        .section {
            margin-bottom: 20px;
        }
        .section-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .vulnerability {
            margin-left: 20px;
            margin-bottom: 10px;
            color: red; /* Set color to red */
        }
        .out-of-date {
            margin-left: 20px;
            margin-bottom: 10px;
            color: orange; /* Set color to orange */
        }
        .vulnerability-title {
            font-weight: bold;
        }
        .vulnerability-details {
            margin-top: 5px;
            margin-bottom: 10px;
        }
        #wpscan-input {
            width: 100%;
            height: 200px;
        }
    </style>
</head>
<body>
    <h1>WPScan Report Generator</h1>

    <form id="wpscan-form">
        <div class="section">
            <label for="wpscan-input">Paste WPScan Results:</label><br>
            <textarea id="wpscan-input" name="wpscan-input" placeholder="Paste WPScan results here..."></textarea>
        </div>
        <button type="submit">Generate Report</button>
    </form>

    <div id="report-container"></div>

    <script>
        document.getElementById('wpscan-form').addEventListener('submit', function(event) {
            event.preventDefault();
            var wpscanInput = document.getElementById('wpscan-input').value;
            generateReport(wpscanInput);
        });

        function generateReport(wpscanInput) {
            var reportContainer = document.getElementById('report-container');
            reportContainer.innerHTML = ''; // Clear previous report

            var lines = wpscanInput.split('\n');
            var section = '';
            var sectionHTML = '';
            var vulnerabilityCount = 0; // Counter for vulnerability identified lines
            var outOfDateCount = 0; // Counter for out of date lines

            lines.forEach(function(line) {
                var lineText = line.trim();
                if (lineText.startsWith('[+]') || lineText.startsWith('[-]') || lineText.startsWith('[i]')) {
                    // Start of a new section
                    if (sectionHTML !== '') {
                        // Append previous section to report container
                        reportContainer.innerHTML += '<div class="section">' + sectionHTML + '</div>';
                        sectionHTML = ''; // Reset section HTML
                    }
                    // Start a new section
                    section = lineText;
                    sectionHTML += '<div class="section-title">' + section + '</div>';
                } else {
                    // Append line to section HTML
                    if (lineText.includes('vulnerability identified') || lineText.includes('vulnerabilities identified')) {
                        vulnerabilityCount++; // Increment counter
                        sectionHTML += '<p class="vulnerability">' + line + '</p>'; // Add class to highlight in red
                    } else if (lineText.includes('out of date')) {
                        outOfDateCount++; // Increment counter
                        sectionHTML += '<p class="out-of-date">' + line + '</p>'; // Add class to highlight in orange
                    } else {
                        sectionHTML += '<p>' + line + '</p>';
                    }
                }
            });

            // Display vulnerability count
            reportContainer.innerHTML = '<div class="section"><p>Total vulnerabilities identified: ' + vulnerabilityCount + '</p></div>' + reportContainer.innerHTML;

            // Display out of date count
            reportContainer.innerHTML = '<div class="section"><p>Total plugins/themes out of date: ' + outOfDateCount + '</p></div>' + reportContainer.innerHTML;
            
            // Append the last section to report container
            reportContainer.innerHTML += '<div class="section">' + sectionHTML + '</div>';
        }
    </script>
</body>
</html>
